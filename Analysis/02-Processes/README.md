# 流程与中断恢复机制

## 目标

- 以可执行流程支撑“去重整合、目录重构、质量保证、持续改进”，并提供可中断/可恢复的操作手册。

## 迭代生命周期（PDCA）

1. 计划 Plan：目标、范围、风险、资源
2. 执行 Do：并行化执行子任务（优先去重与重构）
3. 检查 Check：质量门禁 + 指标评估
4. 行动 Act：经验沉淀 + 标准更新 + 下轮计划

## 检查点设计

- 每个子任务结束时生成检查点：
  - 状态：完成项、未完成项、阻塞项
  - 变更：新增/删除/移动文件清单
  - 指标：字数、交叉引用数、错误数、重复率
  - 恢复指引：下一步操作、所需输入
- 检查点位置：`Analysis/03-Quality/checkpoints/YYYYMMDD-HHMM.md`

## 变更管理

- 变更类型：重命名、移动、合并、拆分、删除
- 记录模板：`Analysis/03-Quality/change_log.md`
- 关联映射：维护 `mappings.json` 追踪旧->新路径

## 去重整合流程

1. 构建索引：收集 `Matter/**`、`Analysis/**` 元数据（标题、摘要、词频、主题）
2. 相似度计算：MinHash + 关键术语重合率
3. 候选集合：重复率 ≥ 0.6 标记为候选
4. 人工复核：保留最佳版本为“主文档”，其他并入附录或删除
5. 引用修复：统一指向主文档并保留别名锚点
6. 结果验收：重复率指标下降、断链为 0

## 目录重构流程

1. 目标结构设计：≤3 层，采用 `NN-Topic` 命名
2. 迁移清单：生成批量移动计划（含回滚脚本）
3. 执行迁移：分批次移动并修复引用
4. 验收：
   - 目录深度 ≤3
   - 单目录文件数 ≤30
   - 所有引用有效

## 质量门禁（见 Quality 目录）

- 语义一致性、术语/符号统一、公式/定理编号、图表与引用、代码可运行性

## 中断恢复操作手册

- 从最近检查点恢复：
  - 阅读 `checkpoints/*` 与 `change_log.md`
  - 若迁移中断，优先执行“引用修复脚本”
  - 若合并中断，保留主文档，其他移动到 `Archive/` 待审
- 恢复完成后，立即生成新检查点并继续 PDCA
